(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c9af99de"],{"71b9":function(e,t,s){"use strict";s("807e")},"7efa":function(e,t,s){"use strict";s("c344")},8038:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"storage-list d-flex flex-direction-column flex-grow"},[t("PopupMessage",{attrs:{content:e.popupMessage,position:"center",type:e.popupType,show:e.triggerPopup},on:{showBack:function(t){e.triggerPopup=!1}}}),t("div",{staticClass:"panel-delete-background",class:e.panelDelete?"show":"hide"},[t("div",{staticClass:"blurred",on:{click:function(t){e.panelDelete=!1}}}),t("div",{staticClass:"panel-delete d-flex flex-direction-column"},[t("div",{staticClass:"choice d-flex"},[t("button",{staticClass:"btn btn-primary",on:{click:e.eatenFood}},[e._v(" Alimento consumato ")]),t("button",{staticClass:"btn",on:{click:e.toGarbage}},[e._v(" Alimento buttato ")])]),e._m(0)])]),t("div",{staticClass:"header d-flex"},[t("div",{staticClass:"d-flex"},[t("h1",[e._v("Storage list")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.storageFilter,expression:"storageFilter"}],attrs:{name:"storage"},on:{change:[function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.storageFilter=t.target.multiple?s:s[0]},e.applyFilter]}},e._l(e.storages,(function(s,i){return t("option",{key:i,domProps:{value:s}},[e._v(" "+e._s(s)+" ")])})),0)]),t("button",{staticClass:"btn btn-primary",on:{click:e.multipleAction}},[e._v(" Store "),t("font-awesome-icon",{attrs:{icon:"fa-solid fa-box"}})],1)]),t("ul",e._l(e.storageList,(function(s,i){return t("li",{key:i,staticClass:"d-flex"},[t("div",{staticClass:"storage-food d-flex",class:e.setDeadlineClass(s)},[t("input",{directives:[{name:"model",rawName:"v-model",value:s.selected,expression:"el.selected"}],attrs:{name:s.name,id:s.name,type:"checkbox"},domProps:{checked:Array.isArray(s.selected)?e._i(s.selected,null)>-1:s.selected},on:{change:[function(t){var i=s.selected,a=t.target,o=!!a.checked;if(Array.isArray(i)){var n=null,l=e._i(i,n);a.checked?l<0&&e.$set(s,"selected",i.concat([n])):l>-1&&e.$set(s,"selected",i.slice(0,l).concat(i.slice(l+1)))}else e.$set(s,"selected",o)},e.changeCheckbox]}}),t("div",{staticClass:"missing-days"},[e._v(" "+e._s(s.missingDays)+" ")]),t("div",{staticClass:"list-name"},[e._v(" "+e._s(s.name)+" ")])]),t("div",{staticClass:"operation d-flex"},[t("div",{staticClass:"delete",on:{click:function(t){return e.deleteFood(i)}}},[t("font-awesome-icon",{attrs:{icon:"fa-solid fa-trash"}})],1),t("div",{staticClass:"toShopping"},[t("font-awesome-icon",{attrs:{icon:"fa-solid fa-cart-shopping"}})],1)])])})),0)],1)},a=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"addToShoppingList"},[t("label",{attrs:{for:"addToShoppingList"}},[e._v("Inserisci a lista della spesa")]),t("input",{attrs:{type:"checkbox",name:"addToShoppingList",id:"addToShoppingList"}})])}],o=s("fe0f"),n=s("e613"),l={name:"StorageList",components:{PopupMessage:n["a"]},props:{},data(){return{user:{},storageListOriginal:[],storageList:[],panelDelete:!1,selected:0,selectedIndex:Number,popupMessage:"",popupType:"",triggerPopup:!1,storages:["All","Frigorifero","Dispensa","Freezer"],storageFilter:"All"}},created(){let e=window.sessionStorage.getItem("userData");null!=e&&(this.user=JSON.parse(e));let t=this;this.getStorageList().then(e=>{t.storageList=e,t.storageListOriginal=e,console.log(t.storageList);let s=new Date;t.storageList.forEach(e=>{let t=new Date(e.deadline);e.selected=!1;var i=t.getTime()-s.getTime();e.missingDays=Math.ceil(i/864e5)})})},methods:{applyFilter(){let e=this;"All"==this.storageFilter?this.storageList=this.storageListOriginal:this.storageList=this.storageListOriginal.filter(t=>{if("storage"in t&&null!==t.storage)return t.storage.toLowerCase()===e.storageFilter.toLowerCase()})},multipleAction(){if(this.selected>0){let e=this.shoppingList.filter(e=>e.selected);console.log(e)}},changeCheckbox(e){e.target.checked?this.selected++:e.target.checked||this.selected--},getStorageList(){return new Promise((e,t)=>{let s=this;o["a"].from("food").select().eq("user_id",s.user.id).eq("shoppingList",!1).order("deadline").then(t=>{e(t.data)}).catch(e=>{t(e)})})},setDeadlineClass(e){let t;return t=e.missingDays<0?"garbage-food":e.missingDays<4?"limit-food":e.missingDays<8?"warning-food":"far-food",t},deleteFood(e){this.panelDelete=!0,this.selectedIndex=e},eatenFood(){let e=this;o["a"].from("food").delete().eq("id",this.storageList[this.selectedIndex].id).then(t=>{console.log(t),e.popupMessage=e.storageList[this.selectedIndex].name+" contrassegnato come mangiato!",e.popupType="success",e.triggerPopup=!0,e.storageList.splice(e.selectedIndex,1),e.panelDelete=!1}).catch(e=>{console.log(e)})},toGarbage(){let e=this,t={deadline:this.storageList[this.selectedIndex].deadline,id:this.storageList[this.selectedIndex].id,name:this.storageList[this.selectedIndex].name,garbage:!0,garbageDate:new Date};o["a"].from("food").update(t).eq("id",t.id).select().then(s=>{console.log(s),e.popupMessage=t.name+" buttato!",e.popupType="success",e.triggerPopup=!0,e.storageList.splice(e.selectedIndex,1),e.panelDelete=!1}).catch(e=>{console.log(e)})}}},r=l,c=(s("71b9"),s("2877")),d=Object(c["a"])(r,i,a,!1,null,null,null);t["default"]=d.exports},"807e":function(e,t,s){},c344:function(e,t,s){},e613:function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"popup-message",class:`${e.type} position-${e.position} ${e.internalShow}`},[e._v(" "+e._s(e.content)+" "),t("div",{staticClass:"cloud-arrow"})])])},a=[],o={name:"PopupMessage",components:{},props:{type:String,show:{type:Boolean,default:!1},content:{type:String,default:""},position:{type:String,default:"bottom"}},data(){return{}},created(){},computed:{internalShow:{get(){return this.show&&this.countDown(),this.show},set(e){this.$emit("showBack",e)}}},methods:{countDown(){setTimeout(()=>{this.internalShow=!1},5e3)}}},n=o,l=(s("7efa"),s("2877")),r=Object(l["a"])(n,i,a,!1,null,null,null);t["a"]=r.exports}}]);